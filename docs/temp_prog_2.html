<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Mladen Cucak; Felipe Dalla Lana; Mauricio Serrano; Paul Esker" />


<title>Temporal disease progress: Linear and non linear regression models</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #2a211c;
    color: #bdae9d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
div.sourceCode
  { color: #bdae9d; background-color: #2a211c; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffff00; } /* Alert */
code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #44aa43; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code span.ch { color: #049b0a; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code span.do { color: #0066ff; font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.dv { color: #44aa43; } /* DecVal */
code span.er { color: #ffff00; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #44aa43; } /* Float */
code span.fu { color: #ff9358; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code span.op { } /* Operator */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.sc { color: #049b0a; } /* SpecialChar */
code span.ss { color: #049b0a; } /* SpecialString */
code span.st { color: #049b0a; } /* String */
code span.va { } /* Variable */
code span.vs { color: #049b0a; } /* VerbatimString */
code span.wa { color: #ffff00; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Plant Disease Epidemiology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-leaf"></span>
     
    Welcome
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Intro
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="install.html">Before starting</a>
    </li>
    <li>
      <a href="intro_r.html">Intro to R</a>
    </li>
    <li>
      <a href="intro_ggplot.html">Intro to ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    PDE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="disease_assessment.html">Disease Assessment</a>
    </li>
    <li>
      <a href="temp_prog_1.html">Temporal progress (part 1)</a>
    </li>
    <li>
      <a href="temp_prog_2.html">Temporal progress (part 2)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Authors.html">Authors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Appendices
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro_to_R.html">Introduction to R</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Temporal disease progress: Linear and non
linear regression models</h1>
<h4 class="author">Mladen Cucak; Felipe Dalla Lana; Mauricio Serrano;
Paul Esker</h4>

</div>


<div id="libraries" class="section level1">
<h1>Libraries</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>list.of.packages <span class="ot">&lt;-</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;tidyverse&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rmarkdown&quot;</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;gt&quot;</span>, <span class="co"># package for customizing html table view</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;DT&quot;</span>, <span class="co"># similar as above</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;kableExtra&quot;</span>, <span class="co"># Another package for html table customization</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rcompanion&quot;</span>, <span class="co"># Useful tool for summarizing model outputs and several other modeling related tasks</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;conflicted&quot;</span>, <span class="co">#Some functions are named the same way across different packages and they can be conflicts and this package helps sorting this problem </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;here&quot;</span>, <span class="co">#helps with the reproducibility across operating systems</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ggResidpanel&quot;</span>, <span class="co"># Diagnostic plots for several models</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;shiny&quot;</span>, <span class="co"># Package for visualization </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;shinythemes&quot;</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;shinydashboard&quot;</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;shinyscreenshot&quot;</span>, <span class="co">#capture screenshots</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;minpack.lm&quot;</span>, <span class="co"># Fitting non-linear models</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;deSolve&quot;</span> <span class="co"># Solvers for Initial Value Problems of Differential Equations</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>new.packages <span class="ot">&lt;-</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  list.of.packages[<span class="sc">!</span>(list.of.packages <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Download packages that are not already present in the library</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(new.packages))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(new.packages)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>packages_load <span class="ot">&lt;-</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(list.of.packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Print warning if there is a problem with installing/loading some of packages</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">as.numeric</span>(packages_load) <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;Package/s: &quot;</span>, <span class="fu">paste</span>(list.of.packages[packages_load <span class="sc">!=</span> <span class="cn">TRUE</span>], <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>), <span class="st">&quot;not loaded!&quot;</span>))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;All packages were successfully loaded.&quot;</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;All packages were successfully loaded.&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(list.of.packages, new.packages, packages_load)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Resolve conflicts</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if(c(&quot;stats&quot;, &quot;dplyr&quot;)%in% installed.packages()){</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conflict_prefer</span>(<span class="st">&quot;filter&quot;</span>, <span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conflict_prefer</span>(<span class="st">&quot;select&quot;</span>, <span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#if install is not working try changing repositories</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ROCR&quot;, repos = c(CRAN=&quot;https://cran.r-project.org/&quot;))</span></span></code></pre></div>
</div>
<div id="linear-regression" class="section level1">
<h1>Linear regression</h1>
<p>Data from the previous exercise is loaded. We shall retain only two
variables (time and disease levels) and a single year of data, in order
to make the following content simpler to understand.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>full_dta <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>( <span class="st">&quot;data/temp_prog/test_data.rds&quot;</span>)) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Take only one year of data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  full_dta <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yr <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>( dai, prop)</span></code></pre></div>
<p><strong>Note</strong>: When working with <code>dplyr</code> it is
useful to have each operation after pipe <code>%&gt;%</code> in next
line as it helps readability of the code.</p>
<p><strong>Challenge:</strong> Try reading lines of code with pipes as a
sentence: Take the <code>full_dta</code> dataset, and filter it to get
only the subset from the first year…</p>
<p><strong>Linear regression</strong> (or <strong>linear model</strong>)
is used to predict a quantitative outcome of the <em>response</em>
variable on the basis of one or more <em>predictor</em> variables. The
general formula is:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \epsilon_i
\]</span></p>
<p>Linear regression is the simplest form of regression but it serves as
a base for many other regression models. Basics of linear regression are
well explained in several resources and here we cover the basics using
R.</p>
<div id="fit-model" class="section level2">
<h2>Fit model</h2>
<p>Fitting models in R’s functional manner usually follows the same
syntax, where:</p>
<ul>
<li><p>Model to be fitted is the defined in the function (lm = linear
model),</p></li>
<li><p>Model formula is the first argument, where the response variable
is separated from predictors with <code>~</code>, and</p></li>
<li><p>additional arguments. In this case, a dataset where variables are
stored.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lin_mod<span class="ot">&lt;-</span><span class="fu">lm</span>(prop<span class="sc">~</span>dai, <span class="at">data =</span> dta)</span></code></pre></div>
<p>Display model diagnostics of fitted linear model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = prop ~ dai, data = dta)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.101813 -0.055089  0.003513  0.054235  0.141471 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.2149241  0.0459598  -4.676 0.000676 ***
## dai          0.0133122  0.0008261  16.114 5.35e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07889 on 11 degrees of freedom
## Multiple R-squared:  0.9594, Adjusted R-squared:  0.9557 
## F-statistic: 259.7 on 1 and 11 DF,  p-value: 5.35e-09</code></pre>
<p>The output above shows the estimate of the regression beta
coefficients (column <code>Estimate</code>) and their significance
levels (column <code>Pr(&gt;|t|)</code>. As the output of fitted model
is saved as a list (run <code>str(lin_mod)</code>to test this), all
elements of the above output can be accessed:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(lin_mod<span class="sc">$</span>coefficients,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## (Intercept)         dai 
##       -0.21        0.01</code></pre>
<p>The estimated regression equation can be written as follows $ prop=
-0.21 + 0.01dai$.</p>
<p>The overall quality of the linear regression fit, commonly referred
to as <em>goodness-of-fit</em>, is presented in in lower part of the
summary output. Common indicators are: Residual Standard Error (RSE),
R-squared (R<sup>2</sup>) and adjusted R<sup>2</sup>, and F-statistic,
which assesses whether at least one predictor variable has a non-zero
coefficient (large = significant).<br />
Judging by all these diagnostics, our model seems to be doing well.
There is only one concern…<br />
<strong>Question</strong>: What does the intercept of -0.21 mean in
terms of our data?<br />
<strong>Question</strong>: What is the rate of disease progress over
time in the above summary of this model?<br />
<strong>Question</strong>: Does this model provide statistically valid
and useful summary of the provided data? Why?</p>
</div>
<div id="model-diagnostics" class="section level2">
<h2>Model diagnostics</h2>
<p>Diagnostic plots as used to test if the linear regression assumptions
have been fulfilled, such as “normality” of residuals.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lin_mod, <span class="at">which=</span><span class="dv">1</span>) <span class="co">#Model assumptions</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lin_mod, <span class="at">which=</span><span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lin_mod, <span class="at">which=</span><span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lin_mod, <span class="at">which=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="temp_prog_2_files/figure-html/diag_plots_lin,%20figures-side-1.png" width="50%" /><img src="temp_prog_2_files/figure-html/diag_plots_lin,%20figures-side-2.png" width="50%" /><img src="temp_prog_2_files/figure-html/diag_plots_lin,%20figures-side-3.png" width="50%" /><img src="temp_prog_2_files/figure-html/diag_plots_lin,%20figures-side-4.png" width="50%" /></p>
<p>A more visually appealing presentation with package
<code>ggresidpanel</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid_panel</span>(lin_mod, <span class="at">qqbands =</span> <span class="cn">TRUE</span>, <span class="at">plots =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="temp_prog_2_files/figure-html/diag_plot_two-1.png" width="672" />
<strong>Question</strong>: What is presented in the Boxplot above?
(Hint: move the cursor to <code>resid_panel()</code> and press F1)</p>
<p>To learn more about this package visit their webpage by running the
following command:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">browseURL</span>(<span class="st">&quot;https://goodekat.github.io/ggResidpanel/&quot;</span>)</span></code></pre></div>
<p>This is only one of several packages developed for model
diagnostics.</p>
<p><strong>Note</strong> Remember, Google is always your best friend,
you just need to know what to ask!</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my_question <span class="ot">&lt;-</span> <span class="st">&quot;R model diagnostics&quot;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">browseURL</span>(<span class="fu">paste0</span>(<span class="st">&#39;https://www.google.co.in/search?q=&#39;</span>, my_question))</span></code></pre></div>
<p><strong>Question</strong>: Plots of residuals reveal some problems
with this fit. Any ideas as to why?<br />
At this point it would be good to visualize the model fit and compare
this with the original data. To do that, it is necessary to calculate
values (=predict) according to the fitted linear model.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dta[ , <span class="st">&quot;Linear&quot;</span>]<span class="ot">&lt;-</span><span class="fu">predict</span>(<span class="at">object=</span>lin_mod,<span class="at">newdata=</span>dta[ , <span class="st">&quot;dai&quot;</span>])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(dta)</span></code></pre></div>
<div id="rbcffuxzbo" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rbcffuxzbo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rbcffuxzbo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbcffuxzbo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rbcffuxzbo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rbcffuxzbo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbcffuxzbo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbcffuxzbo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rbcffuxzbo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rbcffuxzbo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rbcffuxzbo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rbcffuxzbo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rbcffuxzbo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rbcffuxzbo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rbcffuxzbo .gt_from_md > :first-child {
  margin-top: 0;
}

#rbcffuxzbo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rbcffuxzbo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rbcffuxzbo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rbcffuxzbo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rbcffuxzbo .gt_row_group_first td {
  border-top-width: 2px;
}

#rbcffuxzbo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbcffuxzbo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rbcffuxzbo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rbcffuxzbo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbcffuxzbo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbcffuxzbo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rbcffuxzbo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rbcffuxzbo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbcffuxzbo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbcffuxzbo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbcffuxzbo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbcffuxzbo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbcffuxzbo .gt_left {
  text-align: left;
}

#rbcffuxzbo .gt_center {
  text-align: center;
}

#rbcffuxzbo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rbcffuxzbo .gt_font_normal {
  font-weight: normal;
}

#rbcffuxzbo .gt_font_bold {
  font-weight: bold;
}

#rbcffuxzbo .gt_font_italic {
  font-style: italic;
}

#rbcffuxzbo .gt_super {
  font-size: 65%;
}

#rbcffuxzbo .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#rbcffuxzbo .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rbcffuxzbo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rbcffuxzbo .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#rbcffuxzbo .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#rbcffuxzbo .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">dai</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Linear</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0.006420546</td>
<td class="gt_row gt_right">-0.13505081</td></tr>
    <tr><td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">0.025682183</td>
<td class="gt_row gt_right">-0.02855314</td></tr>
    <tr><td class="gt_row gt_right">20</td>
<td class="gt_row gt_right">0.057784912</td>
<td class="gt_row gt_right">0.05132012</td></tr>
    <tr><td class="gt_row gt_right">28</td>
<td class="gt_row gt_right">0.102728732</td>
<td class="gt_row gt_right">0.15781779</td></tr>
    <tr><td class="gt_row gt_right">34</td>
<td class="gt_row gt_right">0.162118780</td>
<td class="gt_row gt_right">0.23769105</td></tr>
    <tr><td class="gt_row gt_right">42</td>
<td class="gt_row gt_right">0.242375602</td>
<td class="gt_row gt_right">0.34418872</td></tr>
    <tr><td class="gt_row gt_right">50</td>
<td class="gt_row gt_right">0.349919743</td>
<td class="gt_row gt_right">0.45068639</td></tr>
    <tr><td class="gt_row gt_right">56</td>
<td class="gt_row gt_right">0.481540931</td>
<td class="gt_row gt_right">0.53055965</td></tr>
    <tr><td class="gt_row gt_right">64</td>
<td class="gt_row gt_right">0.619582665</td>
<td class="gt_row gt_right">0.63705732</td></tr>
    <tr><td class="gt_row gt_right">70</td>
<td class="gt_row gt_right">0.757624398</td>
<td class="gt_row gt_right">0.71693058</td></tr>
    <tr><td class="gt_row gt_right">77</td>
<td class="gt_row gt_right">0.881219904</td>
<td class="gt_row gt_right">0.81011604</td></tr>
    <tr><td class="gt_row gt_right">84</td>
<td class="gt_row gt_right">0.985553772</td>
<td class="gt_row gt_right">0.90330150</td></tr>
    <tr><td class="gt_row gt_right">91</td>
<td class="gt_row gt_right">1.000000000</td>
<td class="gt_row gt_right">0.99648697</td></tr>
  </tbody>
  
  
</table>
</div>
<p><strong>Note</strong>: Data frame must be supplied as an object the
argument <code>newdata</code>.</p>
<p><strong>Challenge</strong>: Why was <code>dta[ , "dai"]</code> used?
Can <code>dta$dai</code> be used? (Hint:<code>predict()</code> and
F1)<br />
<strong>Question</strong>: Why are initial values of linear model
predictions negative? What would that mean in reality?</p>
</div>
<div id="visualize-fit" class="section level2">
<h2>Visualize fit</h2>
<p>The fitted model can be plotted to visualize the general
characteristics of the linear fit, diagnose problems and decide on next
steps. The data needs to be “melted” into a long format to be
plotted.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dta_long <span class="ot">&lt;-</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dta <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;prop&quot;</span>, <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;origin&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;prop&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>               )</span></code></pre></div>
<p><strong>Challenge</strong>: Add comments after each argument of the
function <code>pivot_longer()</code> which explain what do they
accomplish.</p>
<p>Finally, the data are ready for visualization.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dta_long, <span class="fu">aes</span>(dai, prop, <span class="at">color =</span> origin)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.15</span>)) <span class="sc">+</span> <span class="co">#legend into a plotting area</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>, <span class="fl">1.05</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Disease&quot;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">20</span>),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
<p><img src="temp_prog_2_files/figure-html/lin_fit_plot-1.png" width="672" /></p>
<p><strong>Note</strong>: We often recycle the code. This chunk of code
is very similar to the one for visualization of different.</p>
<p><strong>Challenge</strong>: Identify the crucial piece of code which
makes this plot substantially different from the previous one in terms
of visualization.</p>
<p><strong>Question</strong>: Are the reasons for the lack of fit from
the above clearer now?</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>In statistical (and practical) terms the conclusion is that linear
model does a good job in describing the trend in data in this case. In
practical terms, this means that the model told us that the level of
disease is growing over time, hence there is a positive relationship
between time and the level of disease. In statistics, this level of
information is called <strong>descriptive statistics</strong>. However,
if the goal is to better capture the nature of the process and make
predictions, the analysis needs to be more complex, which is in domain
of <strong>inferential statistics</strong>.</p>
</div>
</div>
<div id="using-growth-models-to-explore-temporal-disease-progress"
class="section level1">
<h1>Using growth models to explore temporal disease progress</h1>
<table style="width:100%;">
<colgroup>
<col width="8%" />
<col width="36%" />
<col width="27%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Differential Equation Form</th>
<th>Integrated Form</th>
<th>Linearized Form</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exponential</td>
<td>log<em>y</em>= log<em>y<sub>0</sub></em> + <em>rt</em></td>
<td><em>y</em> = <em>y</em><sub>0</sub>exp(<em>rt</em>)</td>
<td>log<em>y</em> = log<em>y</em><sub>0</sub> + <em>rt</em></td>
</tr>
<tr class="even">
<td>Monomolecular</td>
<td>ln{1/(1-<em>y</em>)} = ln{1/(1- <em>y</em><sub>0</sub>)} +
<em>rt</em></td>
<td><em>y</em> = 1-(1-<em>y</em><sub>0</sub>)exp(-<em>rt</em>)</td>
<td>ln{1/(1-<em>y</em>)} = ln{1/(1- <em>y</em><sub>0</sub>)} +
<em>rt</em></td>
</tr>
<tr class="odd">
<td>Logistic</td>
<td><em>y</em> = 1/[1 + {-ln<em>y</em><sub>0</sub>/(1-
<em>y</em><sub>0</sub>) + <em>rt</em>}]</td>
<td><em>y</em> = 1/[1 + exp{-ln<em>y</em><sub>0</sub>/(1-
<em>y</em><sub>0</sub>) + <em>rt</em>}]</td>
<td>ln(<em>y</em>/(1-<em>y</em>) = ln{<em>y</em><sub>0</sub>/(1-
<em>y</em><sub>0</sub>) + <em>rt</em>}</td>
</tr>
<tr class="even">
<td>Gompertz</td>
<td><em>dy</em>/<em>dt</em> = <em>ry</em> ln(1/<em>y</em>) =
<em>ry</em>(-ln<em>y</em>)</td>
<td><em>y</em> = exp(ln<em>y</em><sub>0</sub>exp(-<em>rt</em>))</td>
<td>-ln(-ln<em>y</em>) = -ln(-ln<em>y</em><sub>0</sub>) +
<em>rt</em></td>
</tr>
<tr class="odd">
<td>Wiebull</td>
<td><div class="line-block"><em>dy</em>/<em>dt</em> =
<em>c</em>/<em>b</em>{(<em>t-a</em>)/<em>b</em>}^(<em>c</em>-1)exp[-{(<em>t-a</em>)/b}<em>c</em>]
|</div></td>
<td><em>y</em> = 1-exp[-{(<em>t-a</em>)/<em>b</em>}^<em>c</em>]</td>
<td>ln[ln{1/(1-<em>y</em>)}] = -<em>clnb</em> + ln(<em>t-a</em>)</td>
</tr>
</tbody>
</table>
<p>The two simplest models of population growth use deterministic
equations to describe the rate of change in the size of a population
over time. In the case of plant pathology, this population would most
often represent the levels of a disease in a field.</p>
<p>The first of these models, exponential growth, describes theoretical
populations that increase in numbers without any limits to their
growth.</p>
<p>The second model, logistic growth, introduces limits to reproductive
population growth as the population size increases. In plant pathology,
this shown by the idea that there is a maximum population size, or in
more specific cases, that there are bounded limits to things such as
disease intensity (0 to 100%).</p>
<p>Thomas Malthus,the English clergyman had a great influence on Charles
Darwin, in developing his theory of natural selection. Malthus’ book
from 1798 states that populations with abundant natural resources grow
very rapidly; however, they limit further growth by depleting their
resources. The pattern of accelerating population size is named
exponential growth. Such development is characteristic of bacteria
multiplication in a flask. However, resources are limited in the real
world and such growth can be characteristic only in very early stages
when a species gets established into a new habitat. Charles Darwin
recognized this as the “struggle for existence”, where the individuals
will compete with members of their own or other species for limited
resources. Those which are more successful than others and are able to
survive and pass pass on the traits that made them successful to the
next generation at a greater rate, a phenomena known as natural
selection. Logistic growth model was developed to model this reality of
limited resources.</p>
<p>This population growth is often limited in several different ways,
e.g. the rate of progress can be different in different parts of a
season, determined by environmental factors, elements of host genetic
resistance or human interventions. Hence, there are several variations
of this logistic curve, one of them being Gompertz curve, named after
Benjamin Gompertz (1779–1865). The main characteristic of this sigmoidal
curve is that the mortality rate decreases exponentially as a person
ages, or in th usual case in plant pathology, the rate of disease
progress is lower as at higher disease intensity levels.</p>
<p>The monomolecular model has been used to described several phenomena
in chemistry (hence the name) and biology (plant growth etc.). It is
also called the negative exponential or restricted exponential model, as
its rate is constantly decreasing. In plant pathology, it is often used
to describe monocyclic epidemics.</p>
<p>They are plotted all together to explore their main characteristics
and differences.</p>
<!-- ```{=html} -->
<!-- <div style="width: 640px; height: 480px; margin: 10px; position: relative;"><iframe allowfullscreen frameborder="0" style="width:640px; height:480px" src="https://mladen-cucak.shinyapps.io/temp_prog/" id="kbUg_0~mFnz0"></iframe></div> -->
<!-- ``` -->
<p>Any <strong>raw</strong> HTML content works here.
For example, here is a Youtube video:</p>

<iframe width="100%" height="400"
  src="https://mladen-cucak.shinyapps.io/temp_prog/"
  frameborder="0" </iframe>
  
  
<!-- # ```{r} -->
<!-- # knitr::include_app("https://mladen-cucak.shinyapps.io/temp_prog/", -->
<!-- #   height = "600px") -->
<!-- # ``` -->
<p>The use of <em>for</em> loops has been introduced. Another very
useful basic programming function which should be easily understandable
is <code>ifelse</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dta <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">ifelse</span>(prop <span class="sc">==</span> <span class="dv">1</span>, <span class="co">#condition for each element of the object, meaning disease intensity is a maximum value</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                       prop <span class="sc">-</span> .<span class="dv">0001</span>, <span class="co"># if the condition is true do this</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                       prop) <span class="co"># in not true do this</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<p>Remove linear model fits and retain only time and disease data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove linear fits </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> dta[ , <span class="fu">c</span>(<span class="st">&quot;dai&quot;</span>, <span class="st">&quot;prop&quot;</span>)]</span></code></pre></div>
<p>The response variable is transformed and the linear model is
re-fitted.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mon_mod<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>prop))<span class="sc">~</span>dai, <span class="at">data =</span> dta) <span class="co"># Monomolecular = log(1/(1-y))</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>exp_mod<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(prop)<span class="sc">~</span>dai, <span class="at">data =</span> dta) <span class="co"># Exponential = log(y)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>log_mod<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(prop<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>prop))<span class="sc">~</span>dai, <span class="at">data =</span> dta) <span class="co"># Logistic = log(y/(1-y))</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>gom_mod<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="sc">-</span><span class="fu">log</span>(prop))<span class="sc">~</span>dai, <span class="at">data =</span> dta) <span class="co"># Gompertz = -log(-log(y))</span></span></code></pre></div>
<p>Model fits are then saved into a list and each element of the list is
named according to the population growth model used.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(mon_mod, exp_mod,log_mod, gom_mod)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;Monomolecular&quot;</span>, <span class="st">&quot;Exponential&quot;</span>, <span class="st">&quot;Logistic&quot;</span>, <span class="st">&quot;Gompertz&quot;</span>)</span></code></pre></div>
<p><strong>Note</strong>: <code>log</code> function is a natural
logarithm.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(prop) ~ dai, data = dta)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.2310 -0.2730  0.2167  0.4098  0.4988 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -4.138435   0.320794 -12.901 5.51e-08 ***
## dai          0.053534   0.005766   9.284 1.55e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5506 on 11 degrees of freedom
## Multiple R-squared:  0.8868, Adjusted R-squared:  0.8765 
## F-statistic: 86.19 on 1 and 11 DF,  p-value: 1.545e-06</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>f_stat <span class="ot">&lt;-</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(models, <span class="cf">function</span>(x) <span class="fu">summary</span>(x)<span class="sc">$</span>fstatistic[<span class="dv">1</span>] <span class="sc">%&gt;%</span> as.numeric <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>rcompanion<span class="sc">::</span><span class="fu">compareLM</span>(mon_mod, exp_mod,log_mod, gom_mod)[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>( <span class="at">Model =</span><span class="fu">names</span>(models),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(., <span class="at">F_statistic =</span> f_stat, <span class="at">.before =</span> <span class="st">&quot;p.value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;No. of Parameters&quot;</span> <span class="ot">=</span> Rank,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;DF&quot;</span> <span class="ot">=</span> <span class="st">&quot;Df.res&quot;</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;R sq.&quot;</span> <span class="ot">=</span> <span class="st">&quot;R.squared&quot;</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Adj. R sq.&quot;</span> <span class="ot">=</span> <span class="st">&quot;Adj.R.sq&quot;</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;F&quot;</span> <span class="ot">=</span> <span class="st">&quot;F_statistic&quot;</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;p&quot;</span> <span class="ot">=</span> <span class="st">&quot;p.value&quot;</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Shapiro-Wilk&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shapiro.W&quot;</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Shapiro-Wilk p&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shapiro.p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>( <span class="st">&quot;AICc&quot;</span>, <span class="st">&quot;BIC&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>( <span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>,<span class="at">full_width =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
No. of Parameters
</th>
<th style="text-align:right;">
DF
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
R sq.
</th>
<th style="text-align:right;">
Adj. R sq.
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
Shapiro-Wilk
</th>
<th style="text-align:right;">
Shapiro-Wilk p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Monomolecular
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
56.42
</td>
<td style="text-align:right;">
0.5463
</td>
<td style="text-align:right;">
0.5051
</td>
<td style="text-align:right;">
13.25
</td>
<td style="text-align:right;">
0.0038900
</td>
<td style="text-align:right;">
0.8229
</td>
<td style="text-align:right;">
0.01293
</td>
</tr>
<tr>
<td style="text-align:left;">
Exponential
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
25.21
</td>
<td style="text-align:right;">
0.8868
</td>
<td style="text-align:right;">
0.8765
</td>
<td style="text-align:right;">
86.19
</td>
<td style="text-align:right;">
0.0000015
</td>
<td style="text-align:right;">
0.8587
</td>
<td style="text-align:right;">
0.03708
</td>
</tr>
<tr>
<td style="text-align:left;">
Logistic
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
51.49
</td>
<td style="text-align:right;">
0.8462
</td>
<td style="text-align:right;">
0.8322
</td>
<td style="text-align:right;">
60.51
</td>
<td style="text-align:right;">
0.0000085
</td>
<td style="text-align:right;">
0.8179
</td>
<td style="text-align:right;">
0.01121
</td>
</tr>
<tr>
<td style="text-align:left;">
Gompertz
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
55.03
</td>
<td style="text-align:right;">
0.6840
</td>
<td style="text-align:right;">
0.6552
</td>
<td style="text-align:right;">
23.81
</td>
<td style="text-align:right;">
0.0004876
</td>
<td style="text-align:right;">
0.8196
</td>
<td style="text-align:right;">
0.01177
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(models)){ <span class="co"># For each model in the list</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a variable with the model name </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">names</span>(models[i]) </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate predictions for that model and save them in a new column</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  dta[ , model_name] <span class="ot">&lt;-</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(<span class="at">object=</span> models[[i]], </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">newdata=</span>dta[ , <span class="st">&quot;dai&quot;</span>])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(<span class="fu">head</span>(dta, <span class="dv">5</span>)) <span class="co"># Show the first five rows</span></span></code></pre></div>
<div id="qmodvjbqsx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qmodvjbqsx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qmodvjbqsx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qmodvjbqsx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qmodvjbqsx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qmodvjbqsx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmodvjbqsx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qmodvjbqsx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qmodvjbqsx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qmodvjbqsx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qmodvjbqsx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qmodvjbqsx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qmodvjbqsx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qmodvjbqsx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qmodvjbqsx .gt_from_md > :first-child {
  margin-top: 0;
}

#qmodvjbqsx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qmodvjbqsx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qmodvjbqsx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qmodvjbqsx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qmodvjbqsx .gt_row_group_first td {
  border-top-width: 2px;
}

#qmodvjbqsx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmodvjbqsx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qmodvjbqsx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qmodvjbqsx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmodvjbqsx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmodvjbqsx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qmodvjbqsx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qmodvjbqsx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmodvjbqsx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qmodvjbqsx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmodvjbqsx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qmodvjbqsx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmodvjbqsx .gt_left {
  text-align: left;
}

#qmodvjbqsx .gt_center {
  text-align: center;
}

#qmodvjbqsx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qmodvjbqsx .gt_font_normal {
  font-weight: normal;
}

#qmodvjbqsx .gt_font_bold {
  font-weight: bold;
}

#qmodvjbqsx .gt_font_italic {
  font-style: italic;
}

#qmodvjbqsx .gt_super {
  font-size: 65%;
}

#qmodvjbqsx .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#qmodvjbqsx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qmodvjbqsx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qmodvjbqsx .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#qmodvjbqsx .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#qmodvjbqsx .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">dai</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Monomolecular</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Exponential</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Logistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Gompertz</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0.006420546</td>
<td class="gt_row gt_right">-1.47707665</td>
<td class="gt_row gt_right">-3.817229</td>
<td class="gt_row gt_right">-5.294305</td>
<td class="gt_row gt_right">-2.8755412</td></tr>
    <tr><td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">0.025682183</td>
<td class="gt_row gt_right">-0.91928065</td>
<td class="gt_row gt_right">-3.388954</td>
<td class="gt_row gt_right">-4.308234</td>
<td class="gt_row gt_right">-2.1667349</td></tr>
    <tr><td class="gt_row gt_right">20</td>
<td class="gt_row gt_right">0.057784912</td>
<td class="gt_row gt_right">-0.50093365</td>
<td class="gt_row gt_right">-3.067747</td>
<td class="gt_row gt_right">-3.568681</td>
<td class="gt_row gt_right">-1.6351301</td></tr>
    <tr><td class="gt_row gt_right">28</td>
<td class="gt_row gt_right">0.102728732</td>
<td class="gt_row gt_right">0.05686235</td>
<td class="gt_row gt_right">-2.639472</td>
<td class="gt_row gt_right">-2.582610</td>
<td class="gt_row gt_right">-0.9263238</td></tr>
    <tr><td class="gt_row gt_right">34</td>
<td class="gt_row gt_right">0.162118780</td>
<td class="gt_row gt_right">0.47520935</td>
<td class="gt_row gt_right">-2.318266</td>
<td class="gt_row gt_right">-1.843057</td>
<td class="gt_row gt_right">-0.3947191</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Fitted values need to be back-transformed because the dependent
variable (disease proportion) was transformed.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dta<span class="sc">$</span>Exponential <span class="ot">&lt;-</span> <span class="fu">exp</span>(dta<span class="sc">$</span>Exponential)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dta<span class="sc">$</span>Monomolecular <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>dta<span class="sc">$</span>Monomolecular)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>dta<span class="sc">$</span>Logistic <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>dta<span class="sc">$</span>Logistic))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>dta<span class="sc">$</span>Gompertz <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>dta<span class="sc">$</span>Gompertz))</span></code></pre></div>
<div id="visualize-fits" class="section level3">
<h3>Visualize fits</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>vars_to_long <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dta)[<span class="sc">!</span><span class="fu">colnames</span>(dta) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;dai&quot;</span>, <span class="st">&quot;prop&quot;</span>)]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>dta_long <span class="ot">&lt;-</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>dta <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> vars_to_long,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">&quot;origin&quot;</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;fits&quot;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## Note: Using an external vector in selections is ambiguous.
## ℹ Use `all_of(vars_to_long)` instead of `vars_to_long` to silence this message.
## ℹ See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.
## This message is displayed once per session.</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dta_long <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(dai, prop),<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(dai, prop),<span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(dai, fits),<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(dai, fits, <span class="at">color =</span> origin),<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>, <span class="fl">1.05</span>)),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;Disease&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">20</span>),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;Time&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>origin, <span class="at">ncol =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<pre><code>## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which will
## replace the existing scale.</code></pre>
<p><img src="temp_prog_2_files/figure-html/lin_fits_plot-1.png" width="100%" height="550" /></p>
</div>
</div>
<div id="nonlinear-regression" class="section level1">
<h1>Nonlinear regression</h1>
<p>In these examples, we will use the nls function to fit different
temporal progress models</p>
<p>The idea here is that we do not transform the data (fewer
assumptions).</p>
<p>The main challenge is defining the starting parameters.</p>
<p>There are different methods to define initial starting parameters,
including:</p>
<p>1. using a grid search approach to find the best combination of all
parameters in the model</p>
<p>2. using preliminary analyses to define the parameters (can be based
on similar data to your situation)</p>
<p>3. functional estimate based on the model form and your knowledge
about the system</p>
<p>4. genetic algorithms, see [for example] (<a
href="https://en.wikipedia.org/wiki/Genetic_algorithm"
class="uri">https://en.wikipedia.org/wiki/Genetic_algorithm</a>)</p>
<p>5. in R there are also for some of the models there are functions
that will obtain initial starting parameters, (see: <a
href="http://www.apsnet.org/edcenter/advanced/topics/EcologyAndEpidemiologyInR/DiseaseProgress/Pages/NonlinearRegression.aspx">Example
on APS page</a>)</p>
<div id="fit-models" class="section level3">
<h3>Fit models</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>FitMod <span class="ot">&lt;-</span><span class="cf">function</span>(mod, data){</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nls</span>(mod,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">list</span>(<span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">rate =</span> <span class="fl">0.05</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">trace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> dta)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Define formula for model.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Monomolecular Model: y=1-((1-y0)*exp(-rate*dai))</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mon_formula <span class="ot">&lt;-</span>  <span class="fu">formula</span>(prop <span class="sc">~</span> <span class="dv">1</span><span class="sc">-</span>((<span class="dv">1</span><span class="sc">-</span>y0)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>rate<span class="sc">*</span>dai)))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Exponential Model: y=y0*exp(rate*dai)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>exp_formula <span class="ot">&lt;-</span>  <span class="fu">formula</span>(prop <span class="sc">~</span> y0 <span class="sc">*</span> <span class="fu">exp</span>(rate<span class="sc">*</span>dai))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Logistic Model: y=1/(1+exp(-(log(y0/(1-y0))+rate*dai)))</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>log_formula <span class="ot">&lt;-</span>  <span class="fu">formula</span>(prop <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="fu">log</span>(y0<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>y0))<span class="sc">+</span>rate<span class="sc">*</span>dai))))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Gompertz Model: y=exp(log(y0)*exp(-rate*dai))</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>gom_formula <span class="ot">&lt;-</span>  <span class="fu">formula</span>(prop <span class="sc">~</span> <span class="fu">exp</span>(<span class="fu">log</span>(y0)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>rate<span class="sc">*</span>dai)))</span></code></pre></div>
<p>Fit models.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mon_mod <span class="ot">&lt;-</span>  <span class="fu">FitMod</span>(mon_formula, dta)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>exp_mod <span class="ot">&lt;-</span>  <span class="fu">FitMod</span>(exp_formula, dta)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>log_mod <span class="ot">&lt;-</span>  <span class="fu">FitMod</span>(log_formula, dta)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>gom_mod <span class="ot">&lt;-</span>  <span class="fu">FitMod</span>(gom_formula, dta)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1677929 :  0.001 0.050</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Error in numericDeriv(form[[3L]], names(ind), env) : </span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   Missing value or an infinity produced when evaluating the model</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># In addition: Warning message:</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># In log(y0) :</span></span></code></pre></div>
<p>Models sometimes fail to converge and we need to provide more
guidance to the algorithm to optimize those parameters, or we need to
consider using a different algorithm.</p>
<p>A different version for parameter searching based on modification of
the Levenberg-Marquardt algorithm is available through
<code>minpack.lm::nlsLM()</code>. The way to write this is very similar
so there is no need for many changes. Note that it is possible to define
upper and lower boundaries for parameters. This helps narrowing down the
parameter search and convergence.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>gom_mod <span class="ot">&lt;-</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>minpack.lm<span class="sc">::</span><span class="fu">nlsLM</span>(prop <span class="sc">~</span> <span class="fu">exp</span>(<span class="fu">log</span>(y0)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>rate<span class="sc">*</span>dai)),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">start=</span><span class="fu">list</span>(<span class="at">y0=</span><span class="fl">0.001</span>, <span class="at">rate=</span><span class="fl">0.075</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxiter =</span> <span class="dv">2000</span>, <span class="at">maxfev =</span> <span class="dv">5000</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">2</span>),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower =</span> <span class="fu">c</span>(<span class="fl">1e-8</span>, .<span class="dv">0001</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> dta)</span></code></pre></div>
<p>Similar to the linear modeling exercise, model fits can be saved into
a list and each element of the list is named according to the population
growth model used.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(mon_mod, exp_mod, log_mod, gom_mod)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;Monomolecular&quot;</span>, <span class="st">&quot;Exponential&quot;</span>, <span class="st">&quot;Logistic&quot;</span>, <span class="st">&quot;Gompertz&quot;</span>)</span></code></pre></div>
<p>A way to estimate the quality of of the fits is to calculate pseudo
<span class="math inline">\(R^2\)</span> value.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>PseudoRsq <span class="ot">&lt;-</span> <span class="cf">function</span>(model, disaese) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  RSS<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  TSS<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">sum</span>((disaese <span class="sc">-</span> <span class="fu">mean</span>(disaese)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">-</span> (RSS<span class="fl">.1</span> <span class="sc">/</span> TSS<span class="fl">.1</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Calculate values and pseudo <span class="math inline">\(R^2\)</span>
for fitted models.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fit_diag <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">models =</span> <span class="fu">names</span>(models), <span class="at">r_sq =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(models)))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(models)){ <span class="co"># For each model in the list</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a variable with the model name </span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">names</span>(models[i]) </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate predictions for that model and save them in a new column</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  dta[ , model_name] <span class="ot">&lt;-</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(<span class="at">object=</span> models[[i]], </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">newdata=</span>dta[ , <span class="st">&quot;dai&quot;</span>])</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  fit_diag[ fit_diag<span class="sc">$</span>models <span class="sc">==</span> model_name, <span class="st">&quot;r_sq&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">PseudoRsq</span>(models[[i]], dta<span class="sc">$</span>prop)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(<span class="fu">head</span>(dta, <span class="dv">5</span>)) <span class="co"># Show the first five rows</span></span></code></pre></div>
<div id="zseukmcfsi" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zseukmcfsi .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zseukmcfsi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zseukmcfsi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zseukmcfsi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zseukmcfsi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zseukmcfsi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zseukmcfsi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zseukmcfsi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zseukmcfsi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zseukmcfsi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zseukmcfsi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zseukmcfsi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zseukmcfsi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zseukmcfsi .gt_from_md > :first-child {
  margin-top: 0;
}

#zseukmcfsi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zseukmcfsi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zseukmcfsi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zseukmcfsi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zseukmcfsi .gt_row_group_first td {
  border-top-width: 2px;
}

#zseukmcfsi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zseukmcfsi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zseukmcfsi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zseukmcfsi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zseukmcfsi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zseukmcfsi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zseukmcfsi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zseukmcfsi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zseukmcfsi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zseukmcfsi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zseukmcfsi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zseukmcfsi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zseukmcfsi .gt_left {
  text-align: left;
}

#zseukmcfsi .gt_center {
  text-align: center;
}

#zseukmcfsi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zseukmcfsi .gt_font_normal {
  font-weight: normal;
}

#zseukmcfsi .gt_font_bold {
  font-weight: bold;
}

#zseukmcfsi .gt_font_italic {
  font-style: italic;
}

#zseukmcfsi .gt_super {
  font-size: 65%;
}

#zseukmcfsi .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#zseukmcfsi .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#zseukmcfsi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zseukmcfsi .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#zseukmcfsi .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#zseukmcfsi .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">dai</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Monomolecular</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Exponential</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Logistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Gompertz</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">6</td>
<td class="gt_row gt_right">0.006420546</td>
<td class="gt_row gt_right">-0.18808801</td>
<td class="gt_row gt_right">0.09974159</td>
<td class="gt_row gt_right">0.01260895</td>
<td class="gt_row gt_right">4.349810e-06</td></tr>
    <tr><td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">0.025682183</td>
<td class="gt_row gt_right">-0.01360878</td>
<td class="gt_row gt_right">0.12566823</td>
<td class="gt_row gt_right">0.02493965</td>
<td class="gt_row gt_right">4.628458e-04</td></tr>
    <tr><td class="gt_row gt_right">20</td>
<td class="gt_row gt_right">0.057784912</td>
<td class="gt_row gt_right">0.10021929</td>
<td class="gt_row gt_right">0.14944708</td>
<td class="gt_row gt_right">0.04128573</td>
<td class="gt_row gt_right">4.620099e-03</td></tr>
    <tr><td class="gt_row gt_right">28</td>
<td class="gt_row gt_right">0.102728732</td>
<td class="gt_row gt_right">0.23235853</td>
<td class="gt_row gt_right">0.18829408</td>
<td class="gt_row gt_right">0.07940511</td>
<td class="gt_row gt_right">3.528151e-02</td></tr>
    <tr><td class="gt_row gt_right">34</td>
<td class="gt_row gt_right">0.162118780</td>
<td class="gt_row gt_right">0.31856453</td>
<td class="gt_row gt_right">0.22392294</td>
<td class="gt_row gt_right">0.12680670</td>
<td class="gt_row gt_right">9.611260e-02</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(fit_diag) </span></code></pre></div>
<div id="hpcbgsfpxg" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hpcbgsfpxg .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hpcbgsfpxg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hpcbgsfpxg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hpcbgsfpxg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hpcbgsfpxg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hpcbgsfpxg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hpcbgsfpxg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hpcbgsfpxg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hpcbgsfpxg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hpcbgsfpxg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hpcbgsfpxg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hpcbgsfpxg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hpcbgsfpxg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hpcbgsfpxg .gt_from_md > :first-child {
  margin-top: 0;
}

#hpcbgsfpxg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hpcbgsfpxg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hpcbgsfpxg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hpcbgsfpxg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hpcbgsfpxg .gt_row_group_first td {
  border-top-width: 2px;
}

#hpcbgsfpxg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpcbgsfpxg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hpcbgsfpxg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hpcbgsfpxg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hpcbgsfpxg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpcbgsfpxg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hpcbgsfpxg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hpcbgsfpxg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hpcbgsfpxg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hpcbgsfpxg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpcbgsfpxg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hpcbgsfpxg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpcbgsfpxg .gt_left {
  text-align: left;
}

#hpcbgsfpxg .gt_center {
  text-align: center;
}

#hpcbgsfpxg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hpcbgsfpxg .gt_font_normal {
  font-weight: normal;
}

#hpcbgsfpxg .gt_font_bold {
  font-weight: bold;
}

#hpcbgsfpxg .gt_font_italic {
  font-style: italic;
}

#hpcbgsfpxg .gt_super {
  font-size: 65%;
}

#hpcbgsfpxg .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#hpcbgsfpxg .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#hpcbgsfpxg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hpcbgsfpxg .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#hpcbgsfpxg .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#hpcbgsfpxg .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">models</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">r_sq</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Monomolecular</td>
<td class="gt_row gt_right">0.8301955</td></tr>
    <tr><td class="gt_row gt_left">Exponential</td>
<td class="gt_row gt_right">0.9376367</td></tr>
    <tr><td class="gt_row gt_left">Logistic</td>
<td class="gt_row gt_right">0.9927921</td></tr>
    <tr><td class="gt_row gt_left">Gompertz</td>
<td class="gt_row gt_right">0.9770406</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="visualize-fits-1" class="section level3">
<h3>Visualize fits</h3>
<p>This code is very similar to the previous one presented earlier. The
only major difference is that the model fit diagnostics are joined to
the data and plotted as a text label.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>vars_to_long <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dta)[<span class="sc">!</span><span class="fu">colnames</span>(dta) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;dai&quot;</span>, <span class="st">&quot;prop&quot;</span>)]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>dta_long <span class="ot">&lt;-</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>dta <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> vars_to_long,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">&quot;models&quot;</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;fits&quot;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., fit_diag, <span class="at">by =</span> <span class="st">&quot;models&quot;</span>) <span class="co">#join model diag. by model</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a> dta_long <span class="sc">%&gt;%</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(dai, prop),<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(dai, prop),<span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>)<span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(dai, fits),<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(dai, fits, <span class="at">color =</span> models),<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels for model fit diag.</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>( <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;R^2: &quot;</span>, <span class="fu">round</span>(r_sq,<span class="dv">2</span>),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">parse=</span>T,<span class="at">x=</span><span class="dv">20</span>,<span class="at">y=</span>.<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>models, <span class="at">ncol =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>),</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;Disease&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">20</span>),</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;Time&quot;</span>)<span class="sc">+</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<p><img src="temp_prog_2_files/figure-html/nlm_fits_plot-1.png" width="100%" height="550" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
